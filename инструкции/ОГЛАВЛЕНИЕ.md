# ИНСТРУКЦИИ QA СИСТЕМЫ ДЛЯ НОРМАТИВНЫХ ДОКУМЕНТОВ ЖКХ

**Дата:** 2026-01-09
**Директория:** `/home/olga/normativ_docs/Волков/`

---

## ОБЗОР

Эта папка содержит полную документацию по QA системе для нормативных документов ЖКХ.

**Структура инструкций:**

1. **[ИНСТРУКЦИЯ.md](ИНСТРУКЦИЯ.md)** - Работа с документами
2. **[ИНДЕКСЫ.md](ИНДЕКСЫ.md)** - Векторные индексы
3. **[ФРОНТЕНД_И_БЭКЕНД.md](ФРОНТЕНД_И_БЭКЕНД.md)** - Веб-интерфейс и API
4. **[ЛОГИ_И_КОНФИГУРАЦИЯ.md](ЛОГИ_И_КОНФИГУРАЦИЯ.md)** - Логи и конфигурация
5. **[СТРУКТУРА_ДОКУМЕНТОВ.md](СТРУКТУРА_ДОКУМЕНТОВ.md)** - Создание структуры документов (НОВОЕ!)
6. **[ПРОМПТЫ_ПРИЛОЖЕНИЯ.md](ПРОМПТЫ_ПРИЛОЖЕНИЯ.md)** - Промпты YandexGPT

---

## БЫСТРЫЙ START

### Для начала работы:

1. **Прочитать:** [ИНСТРУКЦИЯ.md](ИНСТРУКЦИЯ.md) - основные скрипты
2. **Запустить бэкенд:** `python vector-db-test/backend/main_cpu.py`
3. **Запустить фронтенд:** `python run_frontend_server.py`
4. **Открыть в браузере:** http://localhost:8080

### Для создания векторных баз:

1. **Подготовить документ:** Положить в `fulldocx/`
2. **Протестировать чанки:** `python universal_chunker.py "Документ.docx"`
3. **Проверить качество:** `python check_chunk_quality.py reports/test_chunks_*.json`
4. **Создать базу:** `python document_processor.py "Документ.docx"`

---

## ПОДРОБНОЕ ОПИСАНИЕ ИНСТРУКЦИЙ

---

### 1. ИНСТРУКЦИЯ.md - Работа с документами

**Для чего:** Основные скрипты для обработки документов

**Содержит:**
- Описание 4 скриптов:
  - `universal_chunker.py` - разбивка на чанки
  - `check_chunk_quality.py` - проверка качества
  - `document_processor.py` - создание векторной базы
- Пошаговую инструкцию (4 шага)
- Информацию о JSON файлах с чанками
- Рекомендации по размеру чанков

**Кому нужна:**
- Разработчикам для создания векторных баз
- Для понимания workflow обработки документов

**Основные команды:**
```bash
python universal_chunker.py "Документ.docx"
python check_chunk_quality.py reports/test_chunks_government_decree.json "ПП РФ № 354"
python document_processor.py "Документ.docx"
```

---

### 2. ИНДЕКСЫ.md - Векторные индексы

**Для чего:** Полная информация о векторных базах

**Содержит:**
- Список всех 18 векторных индексов
- Описание каждого индекса (кодексы, постановления, приказы, письма)
- Структуру индекса (index.faiss + index.pkl)
- 3 способа проверки работы индекса
- Диагностику проблем
- Инструкцию по пересозданию базы
- Статистику по всем базам

**Кому нужна:**
- Для понимания какие документы есть в системе
- Для диагностики проблем с поиском
- Для пересоздания векторных баз

**Основная информация:**
- Всего баз: 18
- Модель: `intfloat/multilingual-e5-base`
- Размерность: 768
- Пример: ПП РФ № 354 - 692 чанков, 53.2% оптимальных

---

### 3. ФРОНТЕНД_И_БЭКЕНД.md - Веб-интерфейс и API

**Для чего:** Запуск и использование QA системы через веб

**Содержит:**
- Архитектуру системы (бэкенд + фронтенд + векторная база)
- Запуск бэкенда (FastAPI на порту 8001)
- Запуск фронтенда (HTTP сервер на порту 8080)
- Полный запуск системы (3 шага)
- Примеры запросов для тестирования
- Структуру проекта
- Настройку портов
- Диагностику проблем
- API endpoints

**Кому нужна:**
- Для запуска QA системы
- Для тестирования через веб-интерфейс
- Для интеграции с другими системами

**Основные команды:**
```bash
# Запуск бэкенда
python vector-db-test/backend/main_cpu.py

# Запуск фронтенда
python run_frontend_server.py

# Проверка работы
curl http://localhost:8001/health
```

**URL:**
- Документация API: http://localhost:8001/docs
- Веб-интерфейс: http://localhost:8080

---

### 4. ЛОГИ_И_КОНФИГУРАЦИЯ.md - Логи и конфигурация

**Для чего:** Понимание структуры конфигов и логов

**Содержит:**
- Описание 3 конфигов (config.py, .env, .env.example)
- Структуру папок для логов
- processing.log - лог обработки документов
- Настройку логирования
- .gitignore - защиту секретов
- Правила работы с конфигами и логами
- Диагностику проблем

**Кому нужна:**
- Разработчикам для понимания архитектуры
- Для настройки системы
- Для диагностики проблем
- Для эксплуатации

**Основная информация:**
- Конфиги: 3 файла (config.py, .env, .env.example)
- Логи: `logs/processing.log`, `vector-db-test/logs/`
- Уровни: DEBUG, INFO, WARNING, ERROR, CRITICAL

---

### 5. СТРУКТУРА_ДОКУМЕНТОВ.md - Создание структуры документов (НОВОЕ!)

**Для чего:** Автоматическое извлечение структуры из DOCX файлов

**Скрипт:** `/home/olga/normativ_docs/Волков/create_structure.py`

**Содержит:**
- Описание универсального скрипта для создания структур
- Поддерживаемые типы документов (CODE, GOVERNMENT_DECREE, MINISTRY_ORDER, LETTER)
- Что извлекается (разделы, главы, статьи, параграфы, приложения, таблицы)
- Примеры использования
- Массовое создание структур
- Проверку качества структур
- Технические детали алгоритма

**Кому нужна:**
- Для первичной обработки новых документов
- Для улучшения качества чанков векторной базы
- Для понимания структуры документов

**Основные команды:**
```bash
# Создать структуру для одного документа
python3 create_structure.py "Документ.docx"

# Массовое создание структур
for doc in *.docx; do
  python3 create_structure.py "$doc"
done
```

**Результаты (2026-01-09):**
- 8/8 ПП имеют структуры
- 5 документов с полными разделами и параграфами
- 3 документа с приложениями

---

### 6. ПРОМПТЫ_ПРИЛОЖЕНИЯ.md - Промпты YandexGPT

**Для чего:** Понимание промптов YandexGPT для поиска и переформулирования

**Содержит:**
- Все 4 промпта приложения (переформулирование, валидация, реранжирование, упрощение)
- Параметры YandexGPT (temperature, maxTokens, timeout)
- Примеры работы промптов
- Историю изменений
- API endpoints

**Кому нужна:**
- Для понимания как работает AI-поиск
- Для настройки промптов
- Для интеграции с другими системами

---

## СТРУКТУРА ПРОЕКТА

```
/home/olga/normativ_docs/Волков/
├── инструкции/                    # ВСЕ ИНСТРУКЦИИ ЗДЕСЬ
│   ├── ОГЛАВЛЕНИЕ.md              # Этот файл
│   ├── ИНСТРУКЦИЯ.md              # Работа с документами
│   ├── ИНДЕКСЫ.md                 # Векторные индексы
│   ├── ФРОНТЕНД_И_БЭКЕНД.md       # Веб-интерфейс
│   └── ЛОГИ_И_КОНФИГУРАЦИЯ.md     # Логи и конфиги
│
├── config.py                      # Главный конфиг
├── .env                           # Секреты
├── .env.example                   # Пример конфига
│
├── logs/                          # Логи всех скриптов
│   └── processing.log             # Лог обработки документов
│
├── reports/                       # Отчеты (JSON)
│   └── test_chunks_*.json         # Тестовые чанки
│
├── fulldocx/                      # Исходные документы
│
├── vector-db-test/
│   ├── backend/
│   │   └── main_cpu.py            # FastAPI бэкенд (порт 8001)
│   ├── vectordb/                  # 18 векторных баз
│   │   ├── ПП_РФ_№_354/
│   │   ├── ЖК_РФ/
│   │   └── ...
│   └── logs/                      # Логи бэкенда
│
├── frontend/
│   └── index.html                 # Веб-интерфейс
│
├── universal_chunker.py           # Разбивка на чанки
├── check_chunk_quality.py         # Проверка качества
├── document_processor.py          # Создание векторной базы
├── create_structure.py            # Создание структуры (НОВОЕ!)
└── run_frontend_server.py         # Запуск фронтенда
```

---

## ПОРЯДОК ЧТЕНИЯ

### Для первого знакомства:
1. **ОГЛАВЛЕНИЕ.md** (этот файл) - обзор
2. **ИНСТРУКЦИЯ.md** - основные скрипты
3. **ФРОНТЕНД_И_БЭКЕНД.md** - запуск системы

### Для глубокого понимания:
1. **ИНДЕКСЫ.md** - векторные базы
2. **ЛОГИ_И_КОНФИГУРАЦИЯ.md** - конфигурация

### Для эксплуатации:
1. **ФРОНТЕНД_И_БЭКЕНД.md** - запуск
2. **ЛОГИ_И_КОНФИГУРАЦИЯ.md** - диагностика

---

## КОНТАКТЫ

**Проект:** QA система для нормативных документов ЖКХ
**Директория:** `/home/olga/normativ_docs/Волков/`
**Дата:** 2025-01-07

---

## ИЗМЕНЕНИЯ

**2025-01-07:**
- Создана папка `инструкции/`
- Перемещены все инструкции из корня
- Создана новая инструкция "ЛОГИ_И_КОНФИГУРАЦИЯ.md"
- Создано оглавление "ОГЛАВЛЕНИЕ.md"
- Приведена в порядок конфигурация (3 конфига)
- Логи перенесены из `reports/` в `logs/`
