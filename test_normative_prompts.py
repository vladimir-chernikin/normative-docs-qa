#!/usr/bin/env python3
"""
–î–µ—Ç–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ–º–ø—Ç–æ–≤ –≤ –Ω–æ—Ä–º–∞—Ç–∏–≤–Ω—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ö
"""

import re

print("=" * 100)
print("–î–ï–¢–ê–õ–¨–ù–ê–Ø –ü–†–û–í–ï–†–ö–ê –ü–†–û–ú–ü–¢–û–í –ù–û–†–ú–ê–¢–ò–í–ù–´–• –î–û–ö–£–ú–ï–ù–¢–û–í")
print("=" * 100)

# –ü—Ä–æ–º–ø—Ç 1: reformulate_query
prompt1 = """–¢—ã - —ç–∫—Å–ø–µ—Ä—Ç –ø–æ –Ω–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–º –¥–æ–∫—É–º–µ–Ω—Ç–∞–º –ñ–ö–• –†–§.
–ü–µ—Ä–µ—Ñ–æ—Ä–º—É–ª–∏—Ä—É–π –≤–æ–ø—Ä–æ—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ —Ç–µ—Ä–º–∏–Ω–∞—Ö –Ω–æ—Ä–º–∞—Ç–∏–≤–Ω—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤.

–ü–†–ê–í–ò–õ–ê:
1. –ò—Å–ø–æ–ª—å–∑—É–π –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—É—é —Ç–µ—Ä–º–∏–Ω–æ–ª–æ–≥–∏—é –∏–∑ –ñ–ö –†–§, –ü—Ä–∞–≤–∏–ª 354, –ü—Ä–∞–≤–∏–ª 491
2. –ó–∞–º–µ–Ω—è–π —Ä–∞–∑–≥–æ–≤–æ—Ä–Ω—ã–µ —Å–ª–æ–≤–∞ –Ω–∞ —é—Ä–∏–¥–∏—á–µ—Å–∫–∏–µ:
   - "–Ω–∞—á–∏—Å–ª–µ–Ω–∏—è" ‚Üí "—Ä–∞—Å—á–µ—Ç —Ä–∞–∑–º–µ—Ä–∞ –ø–ª–∞—Ç—ã"
   - "–ø–ª–∞—Ç–∏—Ç—å –∑–∞ —Å–≤–µ—Ç" ‚Üí "–∫–æ–º–º—É–Ω–∞–ª—å–Ω–∞—è —É—Å–ª—É–≥–∞ –ø–æ —ç–ª–µ–∫—Ç—Ä–æ—Å–Ω–∞–±–∂–µ–Ω–∏—é"
   - "–º–∫–¥" ‚Üí "–º–Ω–æ–≥–æ–∫–≤–∞—Ä—Ç–∏—Ä–Ω—ã–π –¥–æ–º"
   - "–±–∞—Ç–∞—Ä–µ–∏" ‚Üí "–æ—Ç–æ–ø–ª–µ–Ω–∏–µ"
   - "–ø—Ä–æ—Ç–æ–∫–æ–ª —Å–æ–±—Ä–∞–Ω–∏—è" ‚Üí "–ø—Ä–æ—Ç–æ–∫–æ–ª –æ–±—â–µ–≥–æ —Å–æ–±—Ä–∞–Ω–∏—è —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–∏–∫–æ–≤"
   - "–∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è" ‚Üí "–ø–æ—Ä—è–¥–æ–∫ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è"
3. –°–æ—Ö—Ä–∞–Ω—è–π —Å–º—ã—Å–ª –≤–æ–ø—Ä–æ—Å–∞
4. –ò—Å–ø–æ–ª—å–∑—É–π —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∏ –∏–∑ —Å—Ç–∞—Ç–µ–π –∏ –Ω–æ—Ä–º–∞—Ç–∏–≤–Ω—ã—Ö –∞–∫—Ç–æ–≤
5. –û—Ç–≤–µ—Ç –¢–û–õ–¨–ö–û –ø–µ—Ä–µ—Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–º –≤–æ–ø—Ä–æ—Å–æ–º, –±–µ–∑ –æ–±—ä—è—Å–Ω–µ–Ω–∏–π

–í–û–ü–†–û–° –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–Ø: {original_query}

–£–õ–£–ß–®–ï–ù–ù–´–ô –í–û–ü–†–û–°:"""

# –ü—Ä–æ–º–ø—Ç 2: check_relevance
prompt2 = """–¢—ã - —ç–∫—Å–ø–µ—Ä—Ç –ø–æ –Ω–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–º –¥–æ–∫—É–º–µ–Ω—Ç–∞–º –ñ–ö–• –†–§.
–ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π, –û–¢–í–ï–ß–ê–ï–¢ –ª–∏ –Ω–∞–π–¥–µ–Ω–Ω—ã–π —Ñ—Ä–∞–≥–º–µ–Ω—Ç –Ω–∞ –≤–æ–ø—Ä–æ—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

–í–û–ü–†–û–° –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–Ø:
{query}

–ù–ê–ô–î–ï–ù–ù–´–ô –§–†–ê–ì–ú–ï–ù–¢:
–î–æ–∫—É–º–µ–Ω—Ç: {result.document}
{result.article}
–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ: {result.content[:500]}

–ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–´–ï –ü–†–ê–í–ò–õ–ê –ê–ù–ê–õ–ò–ó–ê:
1. –§—Ä–∞–≥–º–µ–Ω—Ç –¥–æ–ª–∂–µ–Ω –ü–†–Ø–ú–û –∏ –ü–û–õ–ù–û–°–¢–¨–Æ –æ—Ç–≤–µ—á–∞—Ç—å –Ω–∞ –≤–æ–ø—Ä–æ—Å

2. –ü–†–û–í–ï–†–ö–ê –ù–ê –°–ú–ï–®–ê–ù–ù–´–ï –¢–ï–ú–´ (–û–ß–ï–ù–¨ –í–ê–ñ–ù–û!):
   - –ï—Å–ª–∏ —Å–ø—Ä–∞—à–∏–≤–∞—é—Ç –ø—Ä–æ –ö–û–ù–ö–†–ï–¢–ù–£–Æ —É—Å–ª—É–≥—É (–≤–æ–¥–∞/–≥–∞–∑/—Å–≤–µ—Ç/–æ—Ç–æ–ø–ª–µ–Ω–∏–µ), –∞ —Ñ—Ä–∞–≥–º–µ–Ω—Ç –ø–µ—Ä–µ—á–∏—Å–ª—è–µ—Ç –í–°–ï —É—Å–ª—É–≥–∏ —Å—Ä–∞–∑—É ‚Üí –ù–ï –†–ï–õ–ï–í–ê–ù–¢–ï–ù
   - –ü—Ä–∏–º–µ—Ä: —Å–ø—Ä–∞—à–∏–≤–∞—é—Ç "–≤–æ–¥–Ω—ã–µ —Å—á–µ—Ç—á–∏–∫–∏", –∞ –æ—Ç–≤–µ—Ç "–ü–æ–∫–∞–∑–∞–Ω–∏—è —Å–Ω–∏–º–∞—é—Ç—Å—è: –∞) –≤–æ–¥–∞, –±) –≥–∞–∑, –≤) —Å–≤–µ—Ç..." ‚Üí –ù–ï –†–ï–õ–ï–í–ê–ù–¢–ï–ù
   - –ü—Ä–∏–º–µ—Ä: —Å–ø—Ä–∞—à–∏–≤–∞—é—Ç "–æ—Ç–æ–ø–ª–µ–Ω–∏–µ", –∞ –æ—Ç–≤–µ—Ç "–î–ª—è –≤–æ–¥—ã, –≥–∞–∑–∞, –æ—Ç–æ–ø–ª–µ–Ω–∏—è –∏ —ç–ª–µ–∫—Ç—Ä–∏—á–µ—Å—Ç–≤–∞..." ‚Üí –ù–ï –†–ï–õ–ï–í–ê–ù–¢–ï–ù

3. –ï—Å–ª–∏ —Å–ø—Ä–∞—à–∏–≤–∞—é—Ç –ø—Ä–æ –£–°–õ–£–ì–£ –ê (–≤–æ–¥–∞), –∞ –≤ —Ñ—Ä–∞–≥–º–µ–Ω—Ç–µ 50%+ –ø—Ä–æ –£–°–õ–£–ì–£ –ë (–≥–∞–∑, –æ—Ç–æ–ø–ª–µ–Ω–∏–µ) ‚Üí –ù–ï –†–ï–õ–ï–í–ê–ù–¢–ï–ù

4. –Ø–í–ù–û–ï –°–û–í–ü–ê–î–ï–ù–ò–ï:
   - –†–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç—å –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –Ø–í–ù–û–ô, –Ω–µ –∫–æ—Å–≤–µ–Ω–Ω–æ–π
   - –§—Ä–∞–≥–º–µ–Ω—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Å—Ñ–æ–∫—É—Å–∏—Ä–æ–≤–∞–Ω –Ω–∞ –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ–º–æ–π —Ç–µ–º–µ

5. –ï—Å–ª–∏ —Ñ—Ä–∞–≥–º–µ–Ω—Ç mentions –ø–æ—Ö–æ–∂–∏–µ —Ç–µ–º—ã, –Ω–æ –ù–ï –æ—Ç–≤–µ—á–∞–µ—Ç –î–ê–õ–¨–ù–ï–ô–®–ò–ú –Ω–∞ –≤–æ–ø—Ä–æ—Å ‚Üí –ù–ï –†–ï–õ–ï–í–ê–ù–¢–ï–ù

–û–¢–í–ï–¢ –¢–û–õ–¨–ö–û: "–î–ê" –∏–ª–∏ "–ù–ï–¢" """

# –ü—Ä–æ–º–ø—Ç 3: simplify_text
prompt3 = """–¢—ã - —ç–∫—Å–ø–µ—Ä—Ç –ø–æ –Ω–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–º –¥–æ–∫—É–º–µ–Ω—Ç–∞–º –ñ–ö–• –†–§.
–ü–µ—Ä–µ–≤–µ–¥–∏ —é—Ä–∏–¥–∏—á–µ—Å–∫–∏–π —Ç–µ–∫—Å—Ç –Ω–∞ –ø—Ä–æ—Å—Ç–æ–π —Ä—É—Å—Å–∫–∏–π —è–∑—ã–∫ –¥–ª—è –æ–±—ã—á–Ω—ã—Ö –ª—é–¥–µ–π.

–ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–´–ï –ü–†–ê–í–ò–õ–ê:
1. –ù–ï –º–µ–Ω—è–π —é—Ä–∏–¥–∏—á–µ—Å–∫–∏–π —Å–º—ã—Å–ª - —Ç–æ–ª—å–∫–æ —É–ø—Ä–æ—â–∞–π —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∏
2. –°–æ—Ö—Ä–∞–Ω—è–π –≤–∞–∂–Ω—ã–µ —é—Ä–∏–¥–∏—á–µ—Å–∫–∏–µ —Ç–µ—Ä–º–∏–Ω—ã (—é—Ä–∏–¥–∏—á–µ—Å–∫–æ–µ –ª–∏—Ü–æ, –º–Ω–æ–≥–æ–∫–≤–∞—Ä—Ç–∏—Ä–Ω—ã–π –¥–æ–º –∏ —Ç.–¥.)
3. –ù–ï –¥–æ–±–∞–≤–ª—è–π –Ω–∏—á–µ–≥–æ –æ—Ç —Å–µ–±—è - —Ç–æ–ª—å–∫–æ –ø–µ—Ä–µ—Å–∫–∞–∑—ã–≤–∞–π
4. –ò—Å–ø–æ–ª—å–∑—É–π –ø—Ä–æ—Å—Ç—ã–µ —Å–ª–æ–≤–∞ –≤–º–µ—Å—Ç–æ –∫–∞–Ω—Ü–µ–ª—è—Ä—Å–∫–∏—Ö:
   - "–æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç" ‚Üí "–¥–µ–ª–∞–µ—Ç"
   - "–ø—Ä–µ–¥—É—Å–º–æ—Ç—Ä–µ–Ω–Ω—ã–π" ‚Üí "—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–π"
   - "–≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å" ‚Üí "–ø–æ"
5. –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä—É–π –æ—Ç–≤–µ—Ç: –∫—Ä–∞—Ç–∫–∞—è —Å—É—Ç—å + –ø–æ—è—Å–Ω–µ–Ω–∏–µ –ø—Ä–æ—Å—Ç—ã–º–∏ —Å–ª–æ–≤–∞–º–∏
6. –î–ª–∏–Ω–∞ –æ—Ç–≤–µ—Ç–∞: –Ω–µ –±–æ–ª–µ–µ 300 —Å–ª–æ–≤

–ò–°–•–û–î–ù–´–ô –¢–ï–ö–°–¢:
{text_to_simplify}

–û–¢–í–ï–¢:"""

# ============================================================================
# –ü–†–û–í–ï–†–ö–ê –ü–†–û–ú–ü–¢–ê 1: reformulate_query
# ============================================================================
print("\n" + "=" * 100)
print("–ü–†–û–ú–ü–¢ 1: reformulate_query (–ø–µ—Ä–µ—Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–∞)")
print("=" * 100)

print(f"\n–î–ª–∏–Ω–∞: {len(prompt1)} —Å–∏–º–≤–æ–ª–æ–≤")
print(f"–¢–æ–∫–µ–Ω—ã: ~{len(prompt1) // 4}")

checks1 = {
    '–†–æ–ª—å —ç–∫—Å–ø–µ—Ä—Ç–∞': '—ç–∫—Å–ø–µ—Ä—Ç –ø–æ –Ω–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–º –¥–æ–∫—É–º–µ–Ω—Ç–∞–º' in prompt1,
    '–ó–∞–¥–∞—á–∞': '–ü–µ—Ä–µ—Ñ–æ—Ä–º—É–ª–∏—Ä—É–π –≤–æ–ø—Ä–æ—Å' in prompt1,
    '–ü—Ä–∞–≤–∏–ª–∞': '–ü–†–ê–í–ò–õ–ê:' in prompt1,
    '–ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã': len(re.findall(r'‚Üí', prompt1)) > 5,
    '–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–º—ã—Å–ª–∞': '–°–æ—Ö—Ä–∞–Ω—è–π —Å–º—ã—Å–ª' in prompt1,
    '–û—Ñ–∏—Ü–∏–∞–ª—å–Ω–∞—è —Ç–µ—Ä–º–∏–Ω–æ–ª–æ–≥–∏—è': '–æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—É—é —Ç–µ—Ä–º–∏–Ω–æ–ª–æ–≥–∏—é' in prompt1,
    '–ó–∞–ø—Ä–µ—Ç –æ–±—ä—è—Å–Ω–µ–Ω–∏–π': '–±–µ–∑ –æ–±—ä—è—Å–Ω–µ–Ω–∏–π' in prompt1,
    '–°—Å—ã–ª–∫–∏ –Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç—ã': '–ñ–ö –†–§' in prompt1 and '–ü—Ä–∞–≤–∏–ª 354' in prompt1,
    '–ù–µ—Ç —ç–º–æ–¥–∑–∏': len(re.findall(r'[üòÄ-üôèüî•-üØø]', prompt1)) == 0,
}

print("\n–ü—Ä–æ–≤–µ—Ä–∫–∞ —ç–ª–µ–º–µ–Ω—Ç–æ–≤:")
for check, passed in checks1.items():
    status = "‚úÖ" if passed else "‚ùå"
    print(f"  {status} {check}")

quality1 = {
    '–ü—Ä–∏–º–µ—Ä–æ–≤ —Å–ª–æ–≤–æ—Å–æ—á–µ—Ç–∞–Ω–∏–π': len(re.findall(r'".*?"‚Üí".*?"', prompt1)) >= 6,
    '–Æ—Ä–∏–¥–∏—á–µ—Å–∫–∏–µ —Ç–µ—Ä–º–∏–Ω—ã': '–º–Ω–æ–≥–æ–∫–≤–∞—Ä—Ç–∏—Ä–Ω—ã–π –¥–æ–º' in prompt1,
    '–ß–µ—Ç–∫–∏–π —Ñ–æ—Ä–º–∞—Ç': '–£–õ–£–ß–®–ï–ù–ù–´–ô –í–û–ü–†–û–°:' in prompt1,
    'Temperature': 0.3,
    'MaxTokens': 100,
}

print("\n–ö–∞—á–µ—Å—Ç–≤–æ:")
for check, passed in quality1.items():
    status = "‚úÖ" if passed else "‚ùå"
    print(f"  {status} {check}")

if all(checks1.values()):
    print("\n‚úÖ –ü–ü–†–û–ú–ü–¢ 1: –û–¢–õ–ò–ß–ù–û!")
else:
    print("\n‚ö†Ô∏è  –ü–ü–†–û–ú–ü–¢ 1: –ï—Å—Ç—å –ø—Ä–æ–±–ª–µ–º—ã")

# ============================================================================
# –ü–†–û–í–ï–†–ö–ê –ü–†–û–ú–ü–¢–ê 2: check_relevance
# ============================================================================
print("\n" + "=" * 100)
print("–ü–†–û–ú–ü–¢ 2: check_relevance (–ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç–∏)")
print("=" * 100)

print(f"\n–î–ª–∏–Ω–∞: {len(prompt2)} —Å–∏–º–≤–æ–ª–æ–≤")
print(f"–¢–æ–∫–µ–Ω—ã: ~{len(prompt2) // 4}")

checks2 = {
    '–†–æ–ª—å —ç–∫—Å–ø–µ—Ä—Ç–∞': '—ç–∫—Å–ø–µ—Ä—Ç –ø–æ –Ω–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–º –¥–æ–∫—É–º–µ–Ω—Ç–∞–º' in prompt2,
    '–ó–∞–¥–∞—á–∞': '–û–¢–í–ï–ß–ê–ï–¢ –ª–∏ –Ω–∞–π–¥–µ–Ω–Ω—ã–π —Ñ—Ä–∞–≥–º–µ–Ω—Ç' in prompt2,
    '–í–æ–ø—Ä–æ—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è': '–í–û–ü–†–û–° –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–Ø:' in prompt2,
    '–ù–∞–π–¥–µ–Ω–Ω—ã–π —Ñ—Ä–∞–≥–º–µ–Ω—Ç': '–ù–ê–ô–î–ï–ù–ù–´–ô –§–†–ê–ì–ú–ï–ù–¢:' in prompt2,
    '–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–∞–≤–∏–ª–∞': '–ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–´–ï –ü–†–ê–í–ò–õ–ê' in prompt2,
    '–ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Å–º–µ—à–∞–Ω–Ω—ã–µ —Ç–µ–º—ã': '–°–ú–ï–®–ê–ù–ù–´–ï –¢–ï–ú–´' in prompt2,
    '–ü—Ä–∏–º–µ—Ä—ã –ù–ï —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç–∏': len(re.findall(r'‚Üí –ù–ï –†–ï–õ–ï–í–ê–ù–¢–ï–ù', prompt2)) >= 3,
    '–Ø–≤–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ': '–Ø–í–ù–û–ï –°–û–í–ü–ê–î–ï–ù–ò–ï' in prompt2,
    '–§–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–∞ –î–ê/–ù–ï–¢': '–û–¢–í–ï–¢ –¢–û–õ–¨–ö–û: "–î–ê" –∏–ª–∏ "–ù–ï–¢"' in prompt2,
    '–ù–µ—Ç —ç–º–æ–¥–∑–∏': len(re.findall(r'[üòÄ-üôèüî•-üØø]', prompt2)) == 0,
}

print("\n–ü—Ä–æ–≤–µ—Ä–∫–∞ —ç–ª–µ–º–µ–Ω—Ç–æ–≤:")
for check, passed in checks2.items():
    status = "‚úÖ" if passed else "‚ùå"
    print(f"  {status} {check}")

quality2 = {
    '–ü—Ä–∏–º–µ—Ä—ã –≤–æ–¥–Ω—ã—Ö —Å—á–µ—Ç—á–∏–∫–æ–≤': '–≤–æ–¥–Ω—ã–µ —Å—á–µ—Ç—á–∏–∫–∏' in prompt2,
    '–ü—Ä–∏–º–µ—Ä—ã –æ—Ç–æ–ø–ª–µ–Ω–∏—è': '–æ—Ç–æ–ø–ª–µ–Ω–∏–µ' in prompt2,
    '–ü—Ä–∞–≤–∏–ª–æ 50%': '50%+' in prompt2,
    'Temperature': 0.1,
    'MaxTokens': 10,
}

print("\n–ö–∞—á–µ—Å—Ç–≤–æ:")
for check, passed in quality2.items():
    status = "‚úÖ" if passed else "‚ùå"
    print(f"  {status} {check}")

if all(checks2.values()):
    print("\n‚úÖ –ü–ü–†–û–ú–ü–¢ 2: –û–¢–õ–ò–ß–ù–û!")
else:
    print("\n‚ö†Ô∏è  –ü–ü–†–û–ú–ü–¢ 2: –ï—Å—Ç—å –ø—Ä–æ–±–ª–µ–º—ã")

# ============================================================================
# –ü–†–û–í–ï–†–ö–ê –ü–†–û–ú–ü–¢–ê 3: simplify_text
# ============================================================================
print("\n" + "=" * 100)
print("–ü–†–û–ú–ü–¢ 3: simplify_text (—É–ø—Ä–æ—â–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞)")
print("=" * 100)

print(f"\n–î–ª–∏–Ω–∞: {len(prompt3)} —Å–∏–º–≤–æ–ª–æ–≤")
print(f"–¢–æ–∫–µ–Ω—ã: ~{len(prompt3) // 4}")

checks3 = {
    '–†–æ–ª—å —ç–∫—Å–ø–µ—Ä—Ç–∞': '—ç–∫—Å–ø–µ—Ä—Ç –ø–æ –Ω–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–º –¥–æ–∫—É–º–µ–Ω—Ç–∞–º' in prompt3,
    '–ó–∞–¥–∞—á–∞': '–ü–µ—Ä–µ–≤–µ–¥–∏ —é—Ä–∏–¥–∏—á–µ—Å–∫–∏–π —Ç–µ–∫—Å—Ç' in prompt3,
    '–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–∞–≤–∏–ª–∞': '–ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–´–ï –ü–†–ê–í–ò–õ–ê' in prompt3,
    '–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–º—ã—Å–ª–∞': '–ù–ï –º–µ–Ω—è–π —é—Ä–∏–¥–∏—á–µ—Å–∫–∏–π —Å–º—ã—Å–ª' in prompt3,
    '–ü—Ä–∏–º–µ—Ä—ã —É–ø—Ä–æ—â–µ–Ω–∏—è': len(re.findall(r'‚Üí', prompt3)) > 3,
    '–ó–∞–ø—Ä–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω–∏–π': '–ù–ï –¥–æ–±–∞–≤–ª—è–π –Ω–∏—á–µ–≥–æ –æ—Ç —Å–µ–±—è' in prompt3,
    '–õ–∏–º–∏—Ç —Å–ª–æ–≤': '–Ω–µ –±–æ–ª–µ–µ 300 —Å–ª–æ–≤' in prompt3,
    '–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –æ—Ç–≤–µ—Ç–∞': '–∫—Ä–∞—Ç–∫–∞—è —Å—É—Ç—å + –ø–æ—è—Å–Ω–µ–Ω–∏–µ' in prompt3,
    '–ù–µ—Ç —ç–º–æ–¥–∑–∏': len(re.findall(r'[üòÄ-üôèüî•-üØø]', prompt3)) == 0,
}

print("\n–ü—Ä–æ–≤–µ—Ä–∫–∞ —ç–ª–µ–º–µ–Ω—Ç–æ–≤:")
for check, passed in checks3.items():
    status = "‚úÖ" if passed else "‚ùå"
    print(f"  {status} {check}")

quality3 = {
    '–ö–∞–Ω—Ü–µ–ª—è—Ä–∏–∑–º—ã': '–æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç' in prompt3 and '–ø—Ä–µ–¥—É—Å–º–æ—Ç—Ä–µ–Ω–Ω—ã–π' in prompt3,
    '–Æ—Ä–∏–¥–∏—á–µ—Å–∫–∏–µ —Ç–µ—Ä–º–∏–Ω—ã': '—é—Ä–∏–¥–∏—á–µ—Å–∫–æ–µ –ª–∏—Ü–æ' in prompt3,
    'Temperature': 0.3,
    'MaxTokens': 500,
}

print("\n–ö–∞—á–µ—Å—Ç–≤–æ:")
for check, passed in quality3.items():
    status = "‚úÖ" if passed else "‚ùå"
    print(f"  {status} {check}")

if all(checks3.values()):
    print("\n‚úÖ –ü–ü–†–û–ú–ü–¢ 3: –û–¢–õ–ò–ß–ù–û!")
else:
    print("\n‚ö†Ô∏è  –ü–ü–†–û–ú–ü–¢ 3: –ï—Å—Ç—å –ø—Ä–æ–±–ª–µ–º—ã")

# ============================================================================
# –ò–¢–û–ì–û–í–´–ô –û–¢–ß–ï–¢
# ============================================================================
print("\n" + "=" * 100)
print("–ò–¢–û–ì–û–í–´–ô –û–¢–ß–ï–¢")
print("=" * 100)

all_pass = all([
    all(checks1.values()),
    all(checks2.values()),
    all(checks3.values())
])

print(f"""
‚úÖ –ü–†–û–í–ï–†–ï–ù–ù–´–ï –ü–†–û–ú–ü–¢–´ QA –°–ò–°–¢–ï–ú–´:

1. reformulate_query - –ø–µ—Ä–µ—Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–∞
   –î–ª–∏–Ω–∞: {len(prompt1)} —Å–∏–º–≤–æ–ª–æ–≤ (~{len(prompt1)//4} —Ç–æ–∫–µ–Ω–æ–≤)
   - –ü–µ—Ä–µ–≤–æ–¥ —Ä–∞–∑–≥–æ–≤–æ—Ä–Ω—ã—Ö —Å–ª–æ–≤ –≤ —é—Ä–∏–¥–∏—á–µ—Å–∫–∏–µ —Ç–µ—Ä–º–∏–Ω—ã
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–π —Ç–µ—Ä–º–∏–Ω–æ–ª–æ–≥–∏–∏ –ñ–ö –†–§, –ü—Ä–∞–≤–∏–ª 354, 491
   - 6+ –ø—Ä–∏–º–µ—Ä–æ–≤ –∑–∞–º–µ–Ω—ã —Å–ª–æ–≤
   - Temperature: 0.3, MaxTokens: 100

2. check_relevance - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
   –î–ª–∏–Ω–∞: {len(prompt2)} —Å–∏–º–≤–æ–ª–æ–≤ (~{len(prompt2)//4} —Ç–æ–∫–µ–Ω–æ–≤)
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ —á—Ç–æ —Ñ—Ä–∞–≥–º–µ–Ω—Ç –ü–†–Ø–ú–û –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ –≤–æ–ø—Ä–æ—Å
   - –ó–∞—â–∏—Ç–∞ –æ—Ç "—Å–º–µ—à–∞–Ω–Ω—ã—Ö —Ç–µ–º" (–ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏–µ –≤—Å–µ—Ö —É—Å–ª—É–≥)
   - 3+ –ø—Ä–∏–º–µ—Ä–∞ –ù–ï —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç–∏
   - Temperature: 0.1, MaxTokens: 10

3. simplify_text - —É–ø—Ä–æ—â–µ–Ω–∏–µ —é—Ä–∏–¥–∏—á–µ—Å–∫–æ–≥–æ —Ç–µ–∫—Å—Ç–∞
   –î–ª–∏–Ω–∞: {len(prompt3)} —Å–∏–º–≤–æ–ª–æ–≤ (~{len(prompt3)//4} —Ç–æ–∫–µ–Ω–æ–≤)
   - –ü–µ—Ä–µ–≤–æ–¥ —é—Ä–∏–¥–∏—á–µ—Å–∫–æ–≥–æ —è–∑—ã–∫–∞ –Ω–∞ –ø—Ä–æ—Å—Ç–æ–π
   - –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —é—Ä–∏–¥–∏—á–µ—Å–∫–æ–≥–æ —Å–º—ã—Å–ª–∞
   - 4+ –ø—Ä–∏–º–µ—Ä–∞ —É–ø—Ä–æ—â–µ–Ω–∏—è –∫–∞–Ω—Ü–µ–ª—è—Ä–∏–∑–º–æ–≤
   - Temperature: 0.3, MaxTokens: 500

‚úÖ –û–ë–©–ò–ï –ö–†–ò–¢–ï–†–ò–ò –ö–ê–ß–ï–°–¢–í–ê:
- –ß–µ—Ç–∫–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—è–º–∏
- –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞ –∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è
- –ú–Ω–æ–∂–µ—Å—Ç–≤–æ –ø—Ä–∏–º–µ—Ä–æ–≤ (few-shot learning)
- –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —ç–º–æ–¥–∑–∏
- –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Ç–æ–∫–µ–Ω–æ–≤
- –Æ—Ä–∏–¥–∏—á–µ—Å–∫–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å

‚úÖ –°–û–û–¢–í–ï–¢–°–¢–í–ò–ï –¢–†–ï–ë–û–í–ê–ù–ò–Ø–ú:
- QA —Å–∏—Å—Ç–µ–º–∞ –ø–æ –Ω–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–º –¥–æ–∫—É–º–µ–Ω—Ç–∞–º
- –ó–∞—â–∏—Ç–∞ –æ—Ç –æ—à–∏–±–æ–∫ RAG (—Å–º–µ—à–∞–Ω–Ω—ã–µ —Ç–µ–º—ã)
- –£–ø—Ä–æ—â–µ–Ω–∏–µ –¥–ª—è –æ–±—ã—á–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
""")

if all_pass:
    print("üéâ –í–°–ï –ü–†–û–ú–ü–¢–´ –û–¢–õ–ò–ß–ù–´!")
    print("üöÄ QA –°–ò–°–¢–ï–ú–ê –ì–û–¢–û–í–ê –ö –†–ê–ë–û–¢–ï!")
else:
    print("‚ö†Ô∏è  –ï–°–¢–¨ –ü–†–û–ë–õ–ï–ú–´ –í –ü–†–û–ú–ü–¢–ê–•")
